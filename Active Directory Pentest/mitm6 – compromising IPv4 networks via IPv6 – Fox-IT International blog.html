<!DOCTYPE html>
<html lang="en-US">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="profile" href="http://gmpg.org/xfn/11">

<title>mitm6 &#8211; compromising IPv4 networks via IPv6 &#8211; Fox-IT International blog</title>
<script type="text/javascript">
  WebFontConfig = {"google":{"families":["Open+Sans:600:latin,latin-ext","Open+Sans:r,i,b,bi:latin,latin-ext"]}};
  (function() {
    var wf = document.createElement('script');
    wf.src = 'https://blog.fox-it.com/wp-content/mu-plugins/wpcomsh/vendor/automattic/custom-fonts/js/webfont.js';
    wf.type = 'text/javascript';
    wf.async = 'true';
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(wf, s);
	})();
</script><style id="jetpack-custom-fonts-css">.wf-active code, .wf-active kbd, .wf-active pre, .wf-active samp{font-family:"Open Sans",sans-serif}.wf-active body{font-family:"Open Sans",sans-serif}.wf-active button, .wf-active input, .wf-active select{font-family:"Open Sans",sans-serif}.wf-active textarea{font-family:"Open Sans",sans-serif}.wf-active blockquote{font-family:"Open Sans",sans-serif}.wf-active code, .wf-active kbd, .wf-active pre, .wf-active tt, .wf-active var{font-family:"Open Sans",sans-serif}.wf-active .button, .wf-active .more-link, .wf-active button:not(.menu-toggle), .wf-active input[type="button"], .wf-active input[type="reset"], .wf-active input[type="submit"], .wf-active .posts-navigation .nav-links a, .wf-active #content #infinite-handle span button{font-family:"Open Sans",sans-serif}.wf-active input[type="email"], .wf-active input[type="password"], .wf-active input[type="search"], .wf-active input[type="text"], .wf-active input[type="url"], .wf-active textarea{font-family:"Open Sans",sans-serif}.wf-active .post-navigation{font-family:"Open Sans",sans-serif}.wf-active .main-navigation{font-family:"Open Sans",sans-serif}.wf-active .entry-content, .wf-active .entry-summary, .wf-active .page-content{font-family:"Open Sans",sans-serif}.wf-active .entry-content .subtitle{font-family:"Open Sans",sans-serif}.wf-active #comments{font-family:"Open Sans",sans-serif}.wf-active .comment-form label{font-family:"Open Sans",sans-serif}.wf-active .comment-form span.required{font-family:"Open Sans",sans-serif}.wf-active .widget_recent_entries span.post-date{font-family:"Open Sans",sans-serif}.wf-active .site-description{font-family:"Open Sans",sans-serif}.wf-active .site-posted-on time{font-family:"Open Sans",sans-serif}.wf-active .page-header:not(.page-header-light) .taxonomy-description{font-family:"Open Sans",sans-serif}.wf-active .light-text{font-family:"Open Sans",sans-serif}.wf-active .site-info{font-family:"Open Sans",sans-serif}.wf-active .sticky-label{font-family:"Open Sans",sans-serif}.wf-active .post-details, .wf-active .post-details a{font-family:"Open Sans",sans-serif}.wf-active .page-links{font-family:"Open Sans",sans-serif}.wf-active .post-edit-link{font-family:"Open Sans",sans-serif}.wf-active .post-author-card .author-description{font-family:"Open Sans",sans-serif}.wf-active #tinymce h1, .wf-active #tinymce h2, .wf-active #tinymce h3, .wf-active #tinymce h4, .wf-active #tinymce h5, .wf-active #tinymce h6, .wf-active .comment-content h1, .wf-active .comment-content h2, .wf-active .comment-content h3, .wf-active .comment-content h4, .wf-active .comment-content h5, .wf-active .comment-content h6, .wf-active .entry-content h1, .wf-active .entry-content h2, .wf-active .entry-content h3, .wf-active .entry-content h4, .wf-active .entry-content h5, .wf-active .entry-content h6, .wf-active .entry-summary h1, .wf-active .entry-summary h2, .wf-active .entry-summary h3, .wf-active .entry-summary h4, .wf-active .entry-summary h5, .wf-active .entry-summary h6, .wf-active .widget_text h1, .wf-active .widget_text h2, .wf-active .widget_text h3, .wf-active .widget_text h4, .wf-active .widget_text h5, .wf-active .widget_text h6{font-family:"Open Sans",sans-serif;font-style:normal;font-weight:600}.wf-active h1{font-style:normal;font-weight:600}.wf-active h2{font-style:normal;font-weight:600}.wf-active h3{font-style:normal;font-weight:600}.wf-active h4{font-style:normal;font-weight:600}.wf-active h5{font-style:normal;font-weight:600}.wf-active h6{font-style:normal;font-weight:600}.wf-active blockquote h1, .wf-active blockquote h2, .wf-active blockquote h3, .wf-active blockquote h4{font-family:"Open Sans",sans-serif;font-weight:600;font-style:normal}.wf-active div#jp-relatedposts h3.jp-relatedposts-headline em{font-family:"Open Sans",sans-serif;font-style:normal;font-weight:600}.wf-active .comment-reply-title, .wf-active .comments-title{font-family:"Open Sans",sans-serif;font-weight:600;font-style:normal}.wf-active .image-post-title{font-family:"Open Sans",sans-serif;font-weight:600;font-style:normal}.wf-active .page-header:not(.page-header-light) h1{font-style:normal;font-weight:600}.wf-active .not-found .page-header-light .page-title{font-family:"Open Sans",sans-serif;font-style:normal;font-weight:600}.wf-active .archive .archive-title, .wf-active .archive .page-title, .wf-active .search .page-title{font-family:"Open Sans",sans-serif;font-style:normal;font-weight:600}.wf-active .entry-title{font-family:"Open Sans",sans-serif;font-style:normal;font-weight:600}.wf-active #post-cover-image .cover-meta .single-post-title{font-family:"Open Sans",sans-serif;font-style:normal;font-weight:600}.wf-active #hero-header .site-title{font-family:"Open Sans",sans-serif;font-style:normal;font-weight:600}.wf-active .site-header .site-title{font-style:normal;font-weight:600}.wf-active .site-header .site-description{font-style:normal;font-weight:600}</style>
<meta name='robots' content='max-image-preview:large' />
<link rel='dns-prefetch' href='//secure.gravatar.com' />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel='dns-prefetch' href='//widgets.wp.com' />
<link rel='dns-prefetch' href='//jetpack.wordpress.com' />
<link rel='dns-prefetch' href='//s0.wp.com' />
<link rel='dns-prefetch' href='//public-api.wordpress.com' />
<link rel='dns-prefetch' href='//0.gravatar.com' />
<link rel='dns-prefetch' href='//1.gravatar.com' />
<link rel='dns-prefetch' href='//2.gravatar.com' />
<link rel='dns-prefetch' href='//i0.wp.com' />
<link rel='dns-prefetch' href='//c0.wp.com' />
<link href='https://fonts.gstatic.com' crossorigin rel='preconnect' />
<link rel="alternate" type="application/rss+xml" title="Fox-IT International blog &raquo; Feed" href="https://blog.fox-it.com/feed/" />
<link rel="alternate" type="application/rss+xml" title="Fox-IT International blog &raquo; Comments Feed" href="https://blog.fox-it.com/comments/feed/" />
<script type="text/javascript">
window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/14.0.0\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/14.0.0\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/blog.fox-it.com\/wp-includes\/js\/wp-emoji-release.min.js?ver=6.0.2"}};
/*! This file is auto-generated */
!function(e,a,t){var n,r,o,i=a.createElement("canvas"),p=i.getContext&&i.getContext("2d");function s(e,t){var a=String.fromCharCode,e=(p.clearRect(0,0,i.width,i.height),p.fillText(a.apply(this,e),0,0),i.toDataURL());return p.clearRect(0,0,i.width,i.height),p.fillText(a.apply(this,t),0,0),e===i.toDataURL()}function c(e){var t=a.createElement("script");t.src=e,t.defer=t.type="text/javascript",a.getElementsByTagName("head")[0].appendChild(t)}for(o=Array("flag","emoji"),t.supports={everything:!0,everythingExceptFlag:!0},r=0;r<o.length;r++)t.supports[o[r]]=function(e){if(!p||!p.fillText)return!1;switch(p.textBaseline="top",p.font="600 32px Arial",e){case"flag":return s([127987,65039,8205,9895,65039],[127987,65039,8203,9895,65039])?!1:!s([55356,56826,55356,56819],[55356,56826,8203,55356,56819])&&!s([55356,57332,56128,56423,56128,56418,56128,56421,56128,56430,56128,56423,56128,56447],[55356,57332,8203,56128,56423,8203,56128,56418,8203,56128,56421,8203,56128,56430,8203,56128,56423,8203,56128,56447]);case"emoji":return!s([129777,127995,8205,129778,127999],[129777,127995,8203,129778,127999])}return!1}(o[r]),t.supports.everything=t.supports.everything&&t.supports[o[r]],"flag"!==o[r]&&(t.supports.everythingExceptFlag=t.supports.everythingExceptFlag&&t.supports[o[r]]);t.supports.everythingExceptFlag=t.supports.everythingExceptFlag&&!t.supports.flag,t.DOMReady=!1,t.readyCallback=function(){t.DOMReady=!0},t.supports.everything||(n=function(){t.readyCallback()},a.addEventListener?(a.addEventListener("DOMContentLoaded",n,!1),e.addEventListener("load",n,!1)):(e.attachEvent("onload",n),a.attachEvent("onreadystatechange",function(){"complete"===a.readyState&&t.readyCallback()})),(e=t.source||{}).concatemoji?c(e.concatemoji):e.wpemoji&&e.twemoji&&(c(e.twemoji),c(e.wpemoji)))}(window,document,window._wpemojiSettings);
</script>
<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 0.07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
	<link rel='stylesheet' id='all-css-00dc927cbf403ca779e1216645603b29' href='https://blog.fox-it.com/_static/??-eJyVUltqwzAQvFAV0Zaa/JT+BHqAHqDI0qIoXj3QShjfvivjlLg0cfIh2EE7o51ZjUnoGAqEIhNW6wJJWxn2kK3sq0Mje4x6EOj6rPIkqUwIO030ND5KLUfwV6mopliLsNmZ9RsuaKwGSJ5IejBOAbIMMy9BYjpkgWCVnnbehU02313iS86WKx19ioE76HYaOs7+Sf4OcYAEwUDQjsFnPChjJvnVNGjRRlWAyjXFE5Sk9CB9NLVx0A2wMcSZ8s1DSAsBsuMW+r+8911dqUQvuHtV8ulRheGvzLz4FoNZ/BeRao+Ojryzl4XXknqQ2CzN5sWYeCn3Tk9HlcHM2bfSBXtXeBS1Uygw2kgrcOvvnBWax6VurR/+/bnrXvfd/m3f/QACpViF' type='text/css' media='all' />
<style id='wp-block-library-inline-css'>
.has-text-align-justify{text-align:justify;}
</style>
<style id='independent-publisher-2-style-inline-css'>
.cat-links, .post-tags, .tags-links, .byline { clip: rect(1px, 1px, 1px, 1px); height: 1px; position: absolute; overflow: hidden; width: 1px; }
</style>
<style id='global-styles-inline-css'>
body{--wp--preset--color--black: #000000;--wp--preset--color--cyan-bluish-gray: #abb8c3;--wp--preset--color--white: #fff;--wp--preset--color--pale-pink: #f78da7;--wp--preset--color--vivid-red: #cf2e2e;--wp--preset--color--luminous-vivid-orange: #ff6900;--wp--preset--color--luminous-vivid-amber: #fcb900;--wp--preset--color--light-green-cyan: #7bdcb5;--wp--preset--color--vivid-green-cyan: #00d084;--wp--preset--color--pale-cyan-blue: #8ed1fc;--wp--preset--color--vivid-cyan-blue: #0693e3;--wp--preset--color--vivid-purple: #9b51e0;--wp--preset--color--medium-blue: #0087be;--wp--preset--color--bright-blue: #00aadc;--wp--preset--color--dark-gray: #4d4d4b;--wp--preset--color--light-gray: #b3b3b1;--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple: linear-gradient(135deg,rgba(6,147,227,1) 0%,rgb(155,81,224) 100%);--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan: linear-gradient(135deg,rgb(122,220,180) 0%,rgb(0,208,130) 100%);--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange: linear-gradient(135deg,rgba(252,185,0,1) 0%,rgba(255,105,0,1) 100%);--wp--preset--gradient--luminous-vivid-orange-to-vivid-red: linear-gradient(135deg,rgba(255,105,0,1) 0%,rgb(207,46,46) 100%);--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray: linear-gradient(135deg,rgb(238,238,238) 0%,rgb(169,184,195) 100%);--wp--preset--gradient--cool-to-warm-spectrum: linear-gradient(135deg,rgb(74,234,220) 0%,rgb(151,120,209) 20%,rgb(207,42,186) 40%,rgb(238,44,130) 60%,rgb(251,105,98) 80%,rgb(254,248,76) 100%);--wp--preset--gradient--blush-light-purple: linear-gradient(135deg,rgb(255,206,236) 0%,rgb(152,150,240) 100%);--wp--preset--gradient--blush-bordeaux: linear-gradient(135deg,rgb(254,205,165) 0%,rgb(254,45,45) 50%,rgb(107,0,62) 100%);--wp--preset--gradient--luminous-dusk: linear-gradient(135deg,rgb(255,203,112) 0%,rgb(199,81,192) 50%,rgb(65,88,208) 100%);--wp--preset--gradient--pale-ocean: linear-gradient(135deg,rgb(255,245,203) 0%,rgb(182,227,212) 50%,rgb(51,167,181) 100%);--wp--preset--gradient--electric-grass: linear-gradient(135deg,rgb(202,248,128) 0%,rgb(113,206,126) 100%);--wp--preset--gradient--midnight: linear-gradient(135deg,rgb(2,3,129) 0%,rgb(40,116,252) 100%);--wp--preset--duotone--dark-grayscale: url('#wp-duotone-dark-grayscale');--wp--preset--duotone--grayscale: url('#wp-duotone-grayscale');--wp--preset--duotone--purple-yellow: url('#wp-duotone-purple-yellow');--wp--preset--duotone--blue-red: url('#wp-duotone-blue-red');--wp--preset--duotone--midnight: url('#wp-duotone-midnight');--wp--preset--duotone--magenta-yellow: url('#wp-duotone-magenta-yellow');--wp--preset--duotone--purple-green: url('#wp-duotone-purple-green');--wp--preset--duotone--blue-orange: url('#wp-duotone-blue-orange');--wp--preset--font-size--small: 13px;--wp--preset--font-size--medium: 20px;--wp--preset--font-size--large: 36px;--wp--preset--font-size--x-large: 42px;--wp--preset--spacing--20: 0.44rem;--wp--preset--spacing--30: 0.67rem;--wp--preset--spacing--40: 1rem;--wp--preset--spacing--50: 1.5rem;--wp--preset--spacing--60: 2.25rem;--wp--preset--spacing--70: 3.38rem;--wp--preset--spacing--80: 5.06rem;}:where(.is-layout-flex){gap: 0.5em;}body .is-layout-flow > .alignleft{float: left;margin-inline-start: 0;margin-inline-end: 2em;}body .is-layout-flow > .alignright{float: right;margin-inline-start: 2em;margin-inline-end: 0;}body .is-layout-flow > .aligncenter{margin-left: auto !important;margin-right: auto !important;}body .is-layout-constrained > .alignleft{float: left;margin-inline-start: 0;margin-inline-end: 2em;}body .is-layout-constrained > .alignright{float: right;margin-inline-start: 2em;margin-inline-end: 0;}body .is-layout-constrained > .aligncenter{margin-left: auto !important;margin-right: auto !important;}body .is-layout-constrained > :where(:not(.alignleft):not(.alignright):not(.alignfull)){max-width: var(--wp--style--global--content-size);margin-left: auto !important;margin-right: auto !important;}body .is-layout-constrained > .alignwide{max-width: var(--wp--style--global--wide-size);}body .is-layout-flex{display: flex;}body .is-layout-flex{flex-wrap: wrap;align-items: center;}body .is-layout-flex > *{margin: 0;}:where(.wp-block-columns.is-layout-flex){gap: 2em;}.has-black-color{color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-color{color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-color{color: var(--wp--preset--color--white) !important;}.has-pale-pink-color{color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-color{color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-color{color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-color{color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-color{color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-color{color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-color{color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-color{color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-color{color: var(--wp--preset--color--vivid-purple) !important;}.has-black-background-color{background-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-background-color{background-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-background-color{background-color: var(--wp--preset--color--white) !important;}.has-pale-pink-background-color{background-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-background-color{background-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-background-color{background-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-background-color{background-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-background-color{background-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-background-color{background-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-background-color{background-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-background-color{background-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-background-color{background-color: var(--wp--preset--color--vivid-purple) !important;}.has-black-border-color{border-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-border-color{border-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-border-color{border-color: var(--wp--preset--color--white) !important;}.has-pale-pink-border-color{border-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-border-color{border-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-border-color{border-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-border-color{border-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-border-color{border-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-border-color{border-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-border-color{border-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-border-color{border-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-border-color{border-color: var(--wp--preset--color--vivid-purple) !important;}.has-vivid-cyan-blue-to-vivid-purple-gradient-background{background: var(--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple) !important;}.has-light-green-cyan-to-vivid-green-cyan-gradient-background{background: var(--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan) !important;}.has-luminous-vivid-amber-to-luminous-vivid-orange-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange) !important;}.has-luminous-vivid-orange-to-vivid-red-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-orange-to-vivid-red) !important;}.has-very-light-gray-to-cyan-bluish-gray-gradient-background{background: var(--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray) !important;}.has-cool-to-warm-spectrum-gradient-background{background: var(--wp--preset--gradient--cool-to-warm-spectrum) !important;}.has-blush-light-purple-gradient-background{background: var(--wp--preset--gradient--blush-light-purple) !important;}.has-blush-bordeaux-gradient-background{background: var(--wp--preset--gradient--blush-bordeaux) !important;}.has-luminous-dusk-gradient-background{background: var(--wp--preset--gradient--luminous-dusk) !important;}.has-pale-ocean-gradient-background{background: var(--wp--preset--gradient--pale-ocean) !important;}.has-electric-grass-gradient-background{background: var(--wp--preset--gradient--electric-grass) !important;}.has-midnight-gradient-background{background: var(--wp--preset--gradient--midnight) !important;}.has-small-font-size{font-size: var(--wp--preset--font-size--small) !important;}.has-medium-font-size{font-size: var(--wp--preset--font-size--medium) !important;}.has-large-font-size{font-size: var(--wp--preset--font-size--large) !important;}.has-x-large-font-size{font-size: var(--wp--preset--font-size--x-large) !important;}
:where(.wp-block-columns.is-layout-flex){gap: 2em;}
.wp-block-pullquote{font-size: 1.5em;line-height: 1.6;}
.wp-block-navigation a:where(:not(.wp-element-button)){color: inherit;}
</style>
<link rel='stylesheet' id='dashicons-css'  href='https://blog.fox-it.com/wp-includes/css/dashicons.min.css?ver=6.0.2' media='all' />
<style id='jetpack-global-styles-frontend-style-inline-css'>
:root { --font-headings: unset; --font-base: unset; --font-headings-default: -apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Oxygen-Sans,Ubuntu,Cantarell,"Helvetica Neue",sans-serif; --font-base-default: -apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Oxygen-Sans,Ubuntu,Cantarell,"Helvetica Neue",sans-serif;}
</style>
<link rel="https://api.w.org/" href="https://blog.fox-it.com/wp-json/" /><link rel="alternate" type="application/json" href="https://blog.fox-it.com/wp-json/wp/v2/posts/2154" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://blog.fox-it.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://blog.fox-it.com/wp-includes/wlwmanifest.xml" /> 

<link rel="canonical" href="https://blog.fox-it.com/2018/01/11/mitm6-compromising-ipv4-networks-via-ipv6/" />
<link rel='shortlink' href='https://wp.me/pWykx-yK' />
<link rel="alternate" type="application/json+oembed" href="https://blog.fox-it.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fblog.fox-it.com%2F2018%2F01%2F11%2Fmitm6-compromising-ipv4-networks-via-ipv6%2F" />
<link rel="alternate" type="text/xml+oembed" href="https://blog.fox-it.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fblog.fox-it.com%2F2018%2F01%2F11%2Fmitm6-compromising-ipv4-networks-via-ipv6%2F&#038;format=xml" />
<style>img#wpstats{display:none}</style>
			<style type="text/css">
			.recentcomments a {
				display: inline !important;
				padding: 0 !important;
				margin: 0 !important;
			}

			table.recentcommentsavatartop img.avatar, table.recentcommentsavatarend img.avatar {
				border: 0px;
				margin: 0;
			}

			table.recentcommentsavatartop a, table.recentcommentsavatarend a {
				border: 0px !important;
				background-color: transparent !important;
			}

			td.recentcommentsavatarend, td.recentcommentsavatartop {
				padding: 0px 0px 1px 0px;
				margin: 0px;
			}

			td.recentcommentstextend {
				border: none !important;
				padding: 0px 0px 2px 10px;
			}

			.rtl td.recentcommentstextend {
				padding: 0px 10px 2px 0px;
			}

			td.recentcommentstexttop {
				border: none;
				padding: 0px 0px 0px 10px;
			}

			.rtl td.recentcommentstexttop {
				padding: 0px 10px 0px 0px;
			}
		</style>
		<meta name="description" content="While IPv6 adoption is increasing on the internet, company networks that use IPv6 internally are quite rare. However, most companies are unaware that while IPv6 might not be actively in use, all Windows versions since Windows Vista (including server variants) have IPv6 enabled and prefer it over IPv4. In this blog, an attack is presented&hellip;" />
	<style id="independent-publisher-2-custom-header-css" type="text/css">
			.site-title,
		.site-description,
		#hero-header #hero-social-navigation {
			clip: rect(1px, 1px, 1px, 1px);
			position: absolute;
		}
		</style>
	<link rel="amphtml" href="https://blog.fox-it.com/2018/01/11/mitm6-compromising-ipv4-networks-via-ipv6/amp/">			<style type="text/css">
				/* If html does not have either class, do not show lazy loaded images. */
				html:not( .jetpack-lazy-images-js-enabled ):not( .js ) .jetpack-lazy-image {
					display: none;
				}
			</style>
			<script>
				document.documentElement.classList.add(
					'jetpack-lazy-images-js-enabled'
				);
			</script>
		
<!-- Jetpack Open Graph Tags -->
<meta property="og:type" content="article" />
<meta property="og:title" content="mitm6 &#8211; compromising IPv4 networks via IPv6" />
<meta property="og:url" content="https://blog.fox-it.com/2018/01/11/mitm6-compromising-ipv4-networks-via-ipv6/" />
<meta property="og:description" content="While IPv6 adoption is increasing on the internet, company networks that use IPv6 internally are quite rare. However, most companies are unaware that while IPv6 might not be actively in use, all Wiâ€¦" />
<meta property="article:published_time" content="2018-01-11T09:32:11+00:00" />
<meta property="article:modified_time" content="2020-08-12T14:21:05+00:00" />
<meta property="og:site_name" content="Fox-IT International blog" />
<meta property="og:image" content="https://blog.fox-it.com/wp-content/uploads/2018/01/ntlmrelay_final.png" />
<meta property="og:image:width" content="1244" />
<meta property="og:image:height" content="741" />
<meta property="og:image:alt" content="" />
<meta property="og:locale" content="en_US" />
<meta name="twitter:text:title" content="mitm6 &#8211; compromising IPv4 networks via IPv6" />
<meta name="twitter:image" content="https://blog.fox-it.com/wp-content/uploads/2018/01/ntlmrelay_final.png?w=640" />
<meta name="twitter:card" content="summary_large_image" />

<!-- End Jetpack Open Graph Tags -->
<style type="text/css" id="custom-colors-css">.has-header-image .site-title a,.has-header-image .site-title a:visited{color:#fff}@media screen and (max-width:32.374em){.main-navigation ul ul{background:transparent !important}.main-navigation ul ul a{color:inherit !important}}.widget_recent_comments a,.widget_recent_entries a,body,input,select,textarea,.menu-toggle{color:#383838}#infinite-footer .blog-info a:hover,#infinite-footer .blog-credits a:hover{color:#383838}.posts-navigation .nav-links a,.main-navigation ul ul a,.main-navigation>div>ul>li.current-menu-item>ul>li a,.main-navigation>div>ul>li.current_page_item>ul>li a{color:#303030}input[type="button"],input[type="button"]:hover,input[type="reset"],input[type="reset"]:hover,input[type="submit"],input[type="submit"]:hover,button,.button,.button:hover,#content #infinite-handle span button,#content #infinite-handle span button:hover,.more-link,.more-link:hover,.more-link:visited{color:#303030}.site-main>.hentry:nth-child(n+2),.site .infinite-wrap>.hentry:nth-child(n+2),.entry-author-wrapper,.post-navigation,.comment,.page-links a:hover,.main-navigation li{border-color:#ddd}.site-main>.hentry:nth-child(n+2),.site .infinite-wrap>.hentry:nth-child(n+2),.entry-author-wrapper,.post-navigation,.comment,.page-links a:hover,.main-navigation li{border-color:rgba(221,221,221,.25)}#infinite-footer .blog-info a,#infinite-footer .blog-credits,#infinite-footer .blog-credits a{color:#6d6d6d}.post-details,.post-details a,.post-details a:visited,.post-edit-link a,.post-edit-link a:visited{color:#6e6e6c}.post-tags li:first-child,.jetpack-social-navigation li a:hover,.widget_wpcom_social_media_icons_widget li a:hover,.jetpack-social-navigation li a:focus,.widget_wpcom_social_media_icons_widget li a:focus,.jetpack-social-navigation li a:active,.widget_wpcom_social_media_icons_widget li a:active{color:#515151}.jetpack-social-navigation li a,.widget_wpcom_social_media_icons_widget li a{color:#6d6d6d}.post-navigation .nav-links a:hover,.post-navigation .nav-links a:focus,.post-navigation .nav-links a:active,.entry-author .author-bio,.site-posted-on time,.site-description{color:#6d6d6d}.comment .comment-meta,.comment-form label,.light-text,.light-text a,.light-text a:visited,.widget_rss .rss-date,.widget_rss li>cite{color:#6e6e6c}.light-text a:hover{color:#6e6e6c}body{background-color:#fff}#infinite-footer .container{background-color:#fff}#infinite-footer .container{background-color:rgba(255,255,255,.7)}.post-edit-link a{background-color:#f9f9f9}.entry-author .author-title,.entry-title,.entry-title a,.entry-title a:visited,.site-posted-on strong,.site-title,.site-title a,.site-title a:visited,.entry-title a:hover,.site-title a:hover,h1,h2,h3,h4,h5,h6,.page-header:not(.page-header-light) h1,.comment .comment-meta .comment-author .fn{color:#00284d}.comment-form input[type="email"]:active,.comment-form input[type="email"]:focus,.comment-form input[type="password"]:active,.comment-form input[type="password"]:focus,.comment-form input[type="search"]:active,.comment-form input[type="search"]:focus,.comment-form input[type="text"]:active,.comment-form input[type="text"]:focus,.comment-form input[type="url"]:active,.comment-form input[type="url"]:focus,.comment-form textarea:active,.comment-form textarea:focus,blockquote,input[type="email"]:focus,input[type="password"]:focus,input[type="search"]:focus,input[type="text"]:focus,input[type="url"]:focus,textarea:focus{border-color:#1cabe5}.comment .comment-meta .comment-metadata a:hover,.comment-form span.required,.pingback:before,.post-details a:hover,.post-edit-link a:active,.post-edit-link a:focus,.post-edit-link a:hover,.site-info a:hover,.trackback:before,a,a:visited{color:#0b77a2}.main-navigation>div>ul>li.current-menu-item>a,.main-navigation>div>ul>li.current_page_item>a,a:active,a:focus,a:hover,.page-links a:hover{color:#1cabe5}.posts-navigation .nav-links a,.main-navigation ul ul{background-color:#1cabe5}button,input[type="button"],input[type="reset"],input[type="submit"],.button,#content #infinite-handle span button,.more-link{background-color:#1cabe5}button:not(".components-button"):hover,input[type="button"]:hover,input[type="reset"]:hover,input[type="submit"]:hover,.button:hover,#content #infinite-handle span button:hover,.more-link:hover{background-color:#1588b6}</style>
<link rel="icon" href="https://i0.wp.com/blog.fox-it.com/wp-content/uploads/2022/01/cropped-fox-favicon.png?fit=32%2C32&#038;ssl=1" sizes="32x32" />
<link rel="icon" href="https://i0.wp.com/blog.fox-it.com/wp-content/uploads/2022/01/cropped-fox-favicon.png?fit=192%2C192&#038;ssl=1" sizes="192x192" />
<link rel="apple-touch-icon" href="https://i0.wp.com/blog.fox-it.com/wp-content/uploads/2022/01/cropped-fox-favicon.png?fit=180%2C180&#038;ssl=1" />
<meta name="msapplication-TileImage" content="https://i0.wp.com/blog.fox-it.com/wp-content/uploads/2022/01/cropped-fox-favicon.png?fit=270%2C270&#038;ssl=1" />
<link rel="stylesheet" type="text/css" id="wp-custom-css" href="https://blog.fox-it.com/?custom-css=a785352500" /><!-- Jetpack Google Analytics -->
			<script type='text/javascript'>
				var _gaq = _gaq || [];
				_gaq.push(['_setAccount', 'UA-7750533-3']);
_gaq.push(['_trackPageview']);
				(function() {
					var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
					ga.src = ('https:' === document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
					var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
				})();
			</script>
			<!-- End Jetpack Google Analytics -->
</head>

<body class="post-template-default single single-post postid-2154 single-format-standard wp-custom-logo wp-embed-responsive group-blog custom-colors categories-hidden tags-hidden author-hidden">

<div id="page" class="hfeed site">
	<a class="skip-link screen-reader-text" href="#content">Skip to content</a>

	<div id="hero-header" class="site-hero-section">
		<header id="masthead" class="site-header" role="banner">
			<div class="inner">
				<div class="site-branding">
					<a href="https://blog.fox-it.com/" class="custom-logo-link" rel="home"><img width="180" height="49" src="https://i0.wp.com/blog.fox-it.com/wp-content/uploads/2019/02/fox-it-logo.png?fit=180%2C49&amp;ssl=1" class="custom-logo jetpack-lazy-image" alt="Fox-IT International blog" data-attachment-id="2375" data-permalink="https://blog.fox-it.com/fox-it-logo-2/" data-orig-file="https://i0.wp.com/blog.fox-it.com/wp-content/uploads/2019/02/fox-it-logo.png?fit=180%2C49&amp;ssl=1" data-orig-size="180,49" data-comments-opened="0" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="fox-it-logo" data-image-description="" data-image-caption="" data-medium-file="https://i0.wp.com/blog.fox-it.com/wp-content/uploads/2019/02/fox-it-logo.png?fit=180%2C49&amp;ssl=1" data-large-file="https://i0.wp.com/blog.fox-it.com/wp-content/uploads/2019/02/fox-it-logo.png?fit=180%2C49&amp;ssl=1" data-lazy-src="https://i0.wp.com/blog.fox-it.com/wp-content/uploads/2019/02/fox-it-logo.png?fit=180%2C49&amp;ssl=1&amp;is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" /></a>
												<p class="site-title"><a href="https://blog.fox-it.com/" rel="home">Fox-IT International blog</a></p>
													<p class="site-description">News and opinions from Fox-IT</p>
									</div><!-- .site-branding -->

				
									<button class="menu-toggle" aria-controls="primary-menu" aria-expanded="false" id="primary-menu-button">
						Menu					</button><!-- .menu-toggle -->
				
			</div><!-- .inner -->
		</header><!-- #masthead -->
	</div>

				<nav id="site-navigation" class="main-navigation" role="navigation">
			<div class="menu-main-menu-container"><ul id="primary-menu" class="menu"><li id="menu-item-247" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-247"><a href="http://blog.fox-it.com/">Home</a></li>
<li id="menu-item-2346" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2346"><a href="https://blog.fox-it.com/archive/">Archive</a></li>
<li id="menu-item-246" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-246"><a href="http://www.fox-it.com">Back to Fox-IT</a></li>
</ul></div>		</nav><!-- .main-navigation -->
	
	
	
	<div id="content-wrapper" class="content-wrapper">
		<div id="content" class="site-content">

	<div id="primary" class="content-area">
		<main id="main" class="site-main" role="main">

		
			
<article id="post-2154" class="post-2154 post type-post status-publish format-standard hentry category-audits category-blog tag-active-directory tag-hacking tag-ipv6 tag-ntlm-relaying">
			<header class="entry-header">
			<h1 class="entry-title">mitm6 &#8211; compromising IPv4 networks via IPv6</h1>		</header><!-- .entry-header -->		<div class="entry-meta">
			<span class="byline">
				<a href="https://blog.fox-it.com/author/dirkjanm/" title="Posts by dirkjanm" rel="author">dirkjanm</a>			</span>
							<span class="cat-links">
					<a href="https://blog.fox-it.com/category/audits/" rel="category tag">audits</a>, <a href="https://blog.fox-it.com/category/blog/" rel="category tag">Blog</a>				</span><!-- .cat-links -->
			
			
			<span class="published-on">
				<time class="entry-date published" datetime="2018-01-11T11:32:11+02:00">January 11, 2018</time><time class="updated" datetime="2020-08-12T16:21:05+02:00">August 12, 2020</time>			</span>

			<span class="word-count">8 Minutes</span>		</div><!-- .entry-meta -->
	
	<div class="entry-content">
		<p>While IPv6 adoption is increasing on the internet, company networks that use IPv6 internally are quite rare. However, most companies are unaware that while IPv6 might not be actively in use, all Windows versions since Windows Vista (including server variants) have IPv6 enabled and prefer it over IPv4. In this blog, an attack is presented that abuses the default IPv6 configuration in Windows networks to spoof DNS replies by acting as a malicious DNS server and redirect traffic to an attacker specified endpoint. In the second phase of this attack, a new method is outlined to exploit the (infamous) Windows Proxy Auto Discovery (WPAD) feature in order to relay credentials and authenticate to various services within the network. The tool Fox-IT created for this is called mitm6, and is available from the <a href="https://github.com/fox-it/mitm6/">Fox-IT GitHub</a>.</p>
<h2>IPv6 attacks</h2>
<p>Similar to the slow IPv6 adoption, resources about abusing IPv6 are much less prevalent than those describing IPv4 pentesting techniques. While every book and course mentions things such as ARP spoofing, IPv6 is rarely touched on and the tools available to test or abuse IPv6 configurations are limited. The <a href="https://github.com/vanhauser-thc/thc-ipv6/">THC IPV6 Attack toolkit</a> is one of the available tools, and was an inspiration for mitm6. The attack described in this blog is a partial version of the SLAAC attack, which was first described by in 2011 by Alex Waters from the <a href="http://resources.infosecinstitute.com/slaac-attack/">Infosec institute</a>. The SLAAC attack sets up various services to man-in-the-middle all traffic in the network by setting up a rogue IPv6 router. The setup of this attack was later automated with a tool by Neohapsis called <a href="https://labs.neohapsis.com/2013/07/30/picking-up-the-slaac-with-sudden-six/">suddensix</a>.</p>
<p>The downside of the SLAAC attack is that it attempts to create an IPv6 overlay network over the existing IPv4 network for all devices present. This is hardly a desired situation in a penetration test since this rapidly destabilizes the network. Additionally the attack requires quite a few external packages and services to work. mitm6 is a tool which focusses on an easy to setup solution that selectively attacks hosts and spoofs DNS replies, while minimizing the impact on the network&#8217;s regular operation. The result is a python script which requires almost no configuration to set up, and gets the attack running in seconds. When the attack is stopped, the network reverts itself to it&#8217;s previous state within minutes due to the tweaked timeouts set in the tool.</p>
<h2>The mitm6 attack</h2>
<h3>Attack phase 1 &#8211; Primary DNS takeover</h3>
<p>mitm6 starts with listening on the primary interface of the attacker machine for Windows clients requesting an IPv6 configuration via DHCPv6. By default every Windows machine since Windows Vista will request this configuration regularly. This can be seen in a packet capture from Wireshark:</p>
<p><img data-attachment-id="2155" data-permalink="https://blog.fox-it.com/2018/01/11/mitm6-compromising-ipv4-networks-via-ipv6/dhcpv6_cropped/" data-orig-file="https://i0.wp.com/blog.fox-it.com/wp-content/uploads/2018/01/dhcpv6_cropped.png?fit=1082%2C312&amp;ssl=1" data-orig-size="1082,312" data-comments-opened="0" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="dhcpv6_cropped" data-image-description data-image-caption data-medium-file="https://i0.wp.com/blog.fox-it.com/wp-content/uploads/2018/01/dhcpv6_cropped.png?fit=300%2C87&amp;ssl=1" data-large-file="https://i0.wp.com/blog.fox-it.com/wp-content/uploads/2018/01/dhcpv6_cropped.png?fit=800%2C231&amp;ssl=1" class="alignnone size-full wp-image-2155 jetpack-lazy-image" src="https://i0.wp.com/blog.fox-it.com/wp-content/uploads/2018/01/dhcpv6_cropped.png?resize=800%2C231&#038;ssl=1" alt="dhcpv6_cropped" width="800" height="231" data-recalc-dims="1" data-lazy-src="https://i0.wp.com/blog.fox-it.com/wp-content/uploads/2018/01/dhcpv6_cropped.png?resize=800%2C231&amp;is-pending-load=1#038;ssl=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"><noscript><img data-lazy-fallback="1" data-attachment-id="2155" data-permalink="https://blog.fox-it.com/2018/01/11/mitm6-compromising-ipv4-networks-via-ipv6/dhcpv6_cropped/" data-orig-file="https://i0.wp.com/blog.fox-it.com/wp-content/uploads/2018/01/dhcpv6_cropped.png?fit=1082%2C312&amp;ssl=1" data-orig-size="1082,312" data-comments-opened="0" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="dhcpv6_cropped" data-image-description="" data-image-caption="" data-medium-file="https://i0.wp.com/blog.fox-it.com/wp-content/uploads/2018/01/dhcpv6_cropped.png?fit=300%2C87&amp;ssl=1" data-large-file="https://i0.wp.com/blog.fox-it.com/wp-content/uploads/2018/01/dhcpv6_cropped.png?fit=800%2C231&amp;ssl=1" class="alignnone size-full wp-image-2155" src="https://i0.wp.com/blog.fox-it.com/wp-content/uploads/2018/01/dhcpv6_cropped.png?resize=800%2C231&#038;ssl=1" alt="dhcpv6_cropped" width="800" height="231" data-recalc-dims="1"  /></noscript></p>
<p>mitm6 will reply to those DHCPv6 requests, assigning the victim an IPv6 address within the link-local range. While in an actual IPv6 network these addresses are auto-assigned by the hosts themselves and do not need to be configured by a DHCP server, this gives us the opportunity to set the attackers IP as the default IPv6 DNS server for the victims. It should be noted that mitm6 currently only targets Windows based operating systems, since other operating systems like macOS and Linux do not use DHCPv6 for DNS server assignment.</p>
<p>mitm6 does not advertise itself as a gateway, and thus hosts will not actually attempt to communicate with IPv6 hosts outside their local network segment or VLAN. This limits the impact on the network as mitm6 does not attempt to man-in-the-middle all traffic in the network, but instead selectively spoofs hosts (the domain which is filtered on can be specified when running mitm6).</p>
<p>The screenshot below shows mitm6 in action. The tool automatically detects the IP configuration of the attacker machine and replies to DHCPv6 requests sent by clients in the network with a DHCPv6 reply containing the attacker&#8217;s IP as DNS server. Optionally it will periodically send Router Advertisment (RA) messages to alert client that there is an IPv6 network in place and that clients should request an IPv6 adddress via DHCPv6. This will in some cases speed up the attack but is not required for the attack to work, making it possible to execute this attack on networks that have protection against the SLAAC attack with features such as <a href="https://www.juniper.net/documentation/en_US/junos/topics/concept/port-security-ra-guard.html">RA Guard</a>.</p>
<p><img data-attachment-id="2156" data-permalink="https://blog.fox-it.com/2018/01/11/mitm6-compromising-ipv4-networks-via-ipv6/mitm6_cropped/" data-orig-file="https://i0.wp.com/blog.fox-it.com/wp-content/uploads/2018/01/mitm6_cropped.png?fit=1172%2C290&amp;ssl=1" data-orig-size="1172,290" data-comments-opened="0" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="mitm6_cropped" data-image-description data-image-caption data-medium-file="https://i0.wp.com/blog.fox-it.com/wp-content/uploads/2018/01/mitm6_cropped.png?fit=300%2C74&amp;ssl=1" data-large-file="https://i0.wp.com/blog.fox-it.com/wp-content/uploads/2018/01/mitm6_cropped.png?fit=800%2C198&amp;ssl=1" class="alignnone size-full wp-image-2156 jetpack-lazy-image" src="https://i0.wp.com/blog.fox-it.com/wp-content/uploads/2018/01/mitm6_cropped.png?resize=800%2C198&#038;ssl=1" alt="mitm6_cropped" width="800" height="198" data-recalc-dims="1" data-lazy-src="https://i0.wp.com/blog.fox-it.com/wp-content/uploads/2018/01/mitm6_cropped.png?resize=800%2C198&amp;is-pending-load=1#038;ssl=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"><noscript><img data-lazy-fallback="1" data-attachment-id="2156" data-permalink="https://blog.fox-it.com/2018/01/11/mitm6-compromising-ipv4-networks-via-ipv6/mitm6_cropped/" data-orig-file="https://i0.wp.com/blog.fox-it.com/wp-content/uploads/2018/01/mitm6_cropped.png?fit=1172%2C290&amp;ssl=1" data-orig-size="1172,290" data-comments-opened="0" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="mitm6_cropped" data-image-description="" data-image-caption="" data-medium-file="https://i0.wp.com/blog.fox-it.com/wp-content/uploads/2018/01/mitm6_cropped.png?fit=300%2C74&amp;ssl=1" data-large-file="https://i0.wp.com/blog.fox-it.com/wp-content/uploads/2018/01/mitm6_cropped.png?fit=800%2C198&amp;ssl=1" loading="lazy" class="alignnone size-full wp-image-2156" src="https://i0.wp.com/blog.fox-it.com/wp-content/uploads/2018/01/mitm6_cropped.png?resize=800%2C198&#038;ssl=1" alt="mitm6_cropped" width="800" height="198" data-recalc-dims="1"  /></noscript></p>
<h3>Attack phase 2 &#8211; DNS spoofing</h3>
<p>On the victim machine we see that our server is configured as DNS server. Due to the preference of Windows regarding IP protocols, the IPv6 DNS server will be preferred to the IPv4 DNS server. The IPv6 DNS server will be used to query both for A (IPv4) and AAAA (IPv6) records.</p>
<p><img data-attachment-id="2157" data-permalink="https://blog.fox-it.com/2018/01/11/mitm6-compromising-ipv4-networks-via-ipv6/ipconfig_fixed/" data-orig-file="https://i0.wp.com/blog.fox-it.com/wp-content/uploads/2018/01/ipconfig_fixed.png?fit=663%2C404&amp;ssl=1" data-orig-size="663,404" data-comments-opened="0" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="ipconfig_fixed" data-image-description data-image-caption data-medium-file="https://i0.wp.com/blog.fox-it.com/wp-content/uploads/2018/01/ipconfig_fixed.png?fit=300%2C183&amp;ssl=1" data-large-file="https://i0.wp.com/blog.fox-it.com/wp-content/uploads/2018/01/ipconfig_fixed.png?fit=663%2C404&amp;ssl=1" class="alignnone size-full wp-image-2157 jetpack-lazy-image" src="https://i0.wp.com/blog.fox-it.com/wp-content/uploads/2018/01/ipconfig_fixed.png?resize=663%2C404&#038;ssl=1" alt="ipconfig_fixed" width="663" height="404" data-recalc-dims="1" data-lazy-src="https://i0.wp.com/blog.fox-it.com/wp-content/uploads/2018/01/ipconfig_fixed.png?resize=663%2C404&amp;is-pending-load=1#038;ssl=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"><noscript><img data-lazy-fallback="1" data-attachment-id="2157" data-permalink="https://blog.fox-it.com/2018/01/11/mitm6-compromising-ipv4-networks-via-ipv6/ipconfig_fixed/" data-orig-file="https://i0.wp.com/blog.fox-it.com/wp-content/uploads/2018/01/ipconfig_fixed.png?fit=663%2C404&amp;ssl=1" data-orig-size="663,404" data-comments-opened="0" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="ipconfig_fixed" data-image-description="" data-image-caption="" data-medium-file="https://i0.wp.com/blog.fox-it.com/wp-content/uploads/2018/01/ipconfig_fixed.png?fit=300%2C183&amp;ssl=1" data-large-file="https://i0.wp.com/blog.fox-it.com/wp-content/uploads/2018/01/ipconfig_fixed.png?fit=663%2C404&amp;ssl=1" loading="lazy" class="alignnone size-full wp-image-2157" src="https://i0.wp.com/blog.fox-it.com/wp-content/uploads/2018/01/ipconfig_fixed.png?resize=663%2C404&#038;ssl=1" alt="ipconfig_fixed" width="663" height="404" data-recalc-dims="1"  /></noscript></p>
<p>Now our next step is to get clients to connect to the attacker machine instead of the legitimate servers. Our end goal is getting the user or browser to automatically authenticate to the attacker machine, which is why we are spoofing URLs in the internal domain <code>testsegment.local</code>. On the screenshot in step 1 you see the client started requesting information about <code>wpad.testsegment.local</code> immediately after it was assigned an IPv6 address. This is the part we will be exploiting during this attack.</p>
<h2>Exploiting WPAD</h2>
<h3>A (short) history of WPAD abuse</h3>
<p>The Windows Proxy Auto Detection feature has been a much debated one, and one that has been abused by penetration testers for years. Its legitimate use is to automatically detect a network proxy used for connecting to the internet in corporate environments. Historically, the address of the server providing the wpad.dat file (which provides this information) would be resolved using DNS, and if no entry was returned, the address would be resolved via insecure broadcast protocols such as Link-Local Multicast Name Resolution (LLMNR). An attacker could reply to these broadcast name resolution protocols, pretend the WPAD file was located on the attackers server, and then prompt for authentication to access the WPAD file. This authentication was provided by default by Windows without requiring user interaction. This could provide the attacker with NTLM credentials from the user logged in on that computer, which could be used to authenticate to services in a process called <a href="https://blog.fox-it.com/2017/05/09/relaying-credentials-everywhere-with-ntlmrelayx/">NTLM relaying</a>.</p>
<p>In 2016 however, Microsoft published a security bulletin <a href="https://support.microsoft.com/en-us/help/3165191/ms16-077-security-update-for-wpad-june-14--2016">MS16-077</a>, which mitigated this attack by adding two important protections:<br />
&#8211; The location of the WPAD file is no longer requested via broadcast protocols, but only via DNS.<br />
&#8211; Authentication does not occur automatically anymore even if this is requested by the server.</p>
<p>While it is common to encounter machines in networks that are not fully patched and are still displaying the old behaviour of requesting WPAD via LLMNR and automatically authenticating, we come across more and more companies where exploiting WPAD the old-fashioned way does not work anymore.</p>
<h3>Exploiting WPAD post MS16-077</h3>
<p>The first protection, where WPAD is only requested via DNS, can be easily bypassed with mitm6. As soon as the victim machine has set the attacker as IPv6 DNS server, it will start querying for the WPAD configuration of the network. Since these DNS queries are sent to the attacker, it can just reply with its own IP address (either IPv4 or IPv6 depending on what the victim&#8217;s machine asks for). This also works if the organization is already using a WPAD file (though in this case it will break any connections from reaching the internet).</p>
<p>To bypass the second protection, where credentials are no longer provided by default, we need to do a little more work. When the victim requests a WPAD file we won&#8217;t request authentication, but instead provide it with a valid WPAD file where the attacker&#8217;s machine is set as a proxy. When the victim now runs any application that uses the Windows API to connect to the internet or simply starts browsing the web, it will use the attackers machine as a proxy. This works in Edge, Internet Explorer, Firefox and Chrome, since they all respect the WPAD system settings by default.<br />
Now when the victim connects to our &#8220;proxy&#8221; server, which we can identify by the use of the <code>CONNECT</code> HTTP verb, or the presence of a full URI after the <code>GET</code> verb, we reply with a HTTP 407 Proxy Authentication required. This is different from the HTTP code normally used to request authentication, HTTP 401.<br />
IE/Edge and Chrome (which uses IEs settings) will automatically authenticate to the proxy, even on the latest Windows versions. In Firefox this setting can be configured, but it is enabled by default.</p>
<p><img data-attachment-id="2159" data-permalink="https://blog.fox-it.com/2018/01/11/mitm6-compromising-ipv4-networks-via-ipv6/auth-proxies_fixed/" data-orig-file="https://i0.wp.com/blog.fox-it.com/wp-content/uploads/2018/01/auth-proxies_fixed.png?fit=768%2C294&amp;ssl=1" data-orig-size="768,294" data-comments-opened="0" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="auth-proxies_fixed" data-image-description data-image-caption data-medium-file="https://i0.wp.com/blog.fox-it.com/wp-content/uploads/2018/01/auth-proxies_fixed.png?fit=300%2C115&amp;ssl=1" data-large-file="https://i0.wp.com/blog.fox-it.com/wp-content/uploads/2018/01/auth-proxies_fixed.png?fit=768%2C294&amp;ssl=1" class="alignnone size-full wp-image-2159 jetpack-lazy-image" src="https://i0.wp.com/blog.fox-it.com/wp-content/uploads/2018/01/auth-proxies_fixed.png?resize=768%2C294&#038;ssl=1" alt="auth-proxies_fixed" width="768" height="294" data-recalc-dims="1" data-lazy-src="https://i0.wp.com/blog.fox-it.com/wp-content/uploads/2018/01/auth-proxies_fixed.png?resize=768%2C294&amp;is-pending-load=1#038;ssl=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"><noscript><img data-lazy-fallback="1" data-attachment-id="2159" data-permalink="https://blog.fox-it.com/2018/01/11/mitm6-compromising-ipv4-networks-via-ipv6/auth-proxies_fixed/" data-orig-file="https://i0.wp.com/blog.fox-it.com/wp-content/uploads/2018/01/auth-proxies_fixed.png?fit=768%2C294&amp;ssl=1" data-orig-size="768,294" data-comments-opened="0" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="auth-proxies_fixed" data-image-description="" data-image-caption="" data-medium-file="https://i0.wp.com/blog.fox-it.com/wp-content/uploads/2018/01/auth-proxies_fixed.png?fit=300%2C115&amp;ssl=1" data-large-file="https://i0.wp.com/blog.fox-it.com/wp-content/uploads/2018/01/auth-proxies_fixed.png?fit=768%2C294&amp;ssl=1" loading="lazy" class="alignnone size-full wp-image-2159" src="https://i0.wp.com/blog.fox-it.com/wp-content/uploads/2018/01/auth-proxies_fixed.png?resize=768%2C294&#038;ssl=1" alt="auth-proxies_fixed" width="768" height="294" data-recalc-dims="1"  /></noscript></p>
<p>Windows will now happily send the NTLM challenge/response to the attacker, who can relay it to different services. With this relaying attack, the attacker can authenticate as the victim on services, access information on websites and shares, and if the victim has enough privileges, the attacker can even execute code on computers or even take over the entire Windows Domain. Some of the possibilities of NTLM relaying were explained in one of our previous blogs, which can be found <a href="https://www.fox-it.com/en/insights/blogs/blog/inside-windows-network/">here</a>.</p>
<h2>The full attack</h2>
<p>The previous sections described the global idea behind the attack. Running the attack itself is quite straightforward. First we start mitm6, which will start replying to DHCPv6 requests and afterwards to DNS queries requesting names in the internal network. For the second part of our attack, we use our favorite relaying tool, <a href="https://github.com/CoreSecurity/impacket/blob/master/examples/ntlmrelayx.py">ntlmrelayx</a>. This tool is part of the <a href="https://github.com/CoreSecurity/impacket/">impacket</a> Python library by Core Security and is an improvement on the well-known smbrelayx tool, supporting several protocols to relay to. Core Security and Fox-IT recently worked together on improving ntlmrelayx, adding several new features which (among others) enable it to relay via IPv6, serve the WPAD file, automatically detect proxy requests and prompt the victim for the correct authentication. If you want to check out some of the new features, have a look at the <a href="https://github.com/CoreSecurity/impacket/tree/relay-experimental/examples">relay-experimental branch</a>.</p>
<p>To serve the WPAD file, all we need to add to the command prompt is the host is the <code>-wh</code> parameter and with it specify the host that the WPAD file resides on. Since mitm6 gives us control over the DNS, any non-existing hostname in the victim network will do. To make sure ntlmrelayx listens on both IPv4 and IPv6, use the <code>-6</code> parameter. The screenshots below show both tools in action, mitm6 selectively spoofing DNS replies and ntlmrelayx serving the WPAD file and then relaying authentication to other servers in the network.</p>
<p><img data-attachment-id="2160" data-permalink="https://blog.fox-it.com/2018/01/11/mitm6-compromising-ipv4-networks-via-ipv6/ntlmrelay_final/" data-orig-file="https://i0.wp.com/blog.fox-it.com/wp-content/uploads/2018/01/ntlmrelay_final.png?fit=1244%2C741&amp;ssl=1" data-orig-size="1244,741" data-comments-opened="0" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="ntlmrelay_final" data-image-description data-image-caption data-medium-file="https://i0.wp.com/blog.fox-it.com/wp-content/uploads/2018/01/ntlmrelay_final.png?fit=300%2C179&amp;ssl=1" data-large-file="https://i0.wp.com/blog.fox-it.com/wp-content/uploads/2018/01/ntlmrelay_final.png?fit=800%2C477&amp;ssl=1" class="alignnone size-full wp-image-2160 jetpack-lazy-image" src="https://i0.wp.com/blog.fox-it.com/wp-content/uploads/2018/01/ntlmrelay_final.png?resize=800%2C477&#038;ssl=1" alt="ntlmrelay_final" width="800" height="477" data-recalc-dims="1" data-lazy-src="https://i0.wp.com/blog.fox-it.com/wp-content/uploads/2018/01/ntlmrelay_final.png?resize=800%2C477&amp;is-pending-load=1#038;ssl=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"><noscript><img data-lazy-fallback="1" data-attachment-id="2160" data-permalink="https://blog.fox-it.com/2018/01/11/mitm6-compromising-ipv4-networks-via-ipv6/ntlmrelay_final/" data-orig-file="https://i0.wp.com/blog.fox-it.com/wp-content/uploads/2018/01/ntlmrelay_final.png?fit=1244%2C741&amp;ssl=1" data-orig-size="1244,741" data-comments-opened="0" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="ntlmrelay_final" data-image-description="" data-image-caption="" data-medium-file="https://i0.wp.com/blog.fox-it.com/wp-content/uploads/2018/01/ntlmrelay_final.png?fit=300%2C179&amp;ssl=1" data-large-file="https://i0.wp.com/blog.fox-it.com/wp-content/uploads/2018/01/ntlmrelay_final.png?fit=800%2C477&amp;ssl=1" loading="lazy" class="alignnone size-full wp-image-2160" src="https://i0.wp.com/blog.fox-it.com/wp-content/uploads/2018/01/ntlmrelay_final.png?resize=800%2C477&#038;ssl=1" alt="ntlmrelay_final" width="800" height="477" data-recalc-dims="1"  /></noscript><img data-attachment-id="2156" data-permalink="https://blog.fox-it.com/2018/01/11/mitm6-compromising-ipv4-networks-via-ipv6/mitm6_cropped/" data-orig-file="https://i0.wp.com/blog.fox-it.com/wp-content/uploads/2018/01/mitm6_cropped.png?fit=1172%2C290&amp;ssl=1" data-orig-size="1172,290" data-comments-opened="0" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="mitm6_cropped" data-image-description data-image-caption data-medium-file="https://i0.wp.com/blog.fox-it.com/wp-content/uploads/2018/01/mitm6_cropped.png?fit=300%2C74&amp;ssl=1" data-large-file="https://i0.wp.com/blog.fox-it.com/wp-content/uploads/2018/01/mitm6_cropped.png?fit=800%2C198&amp;ssl=1" class="alignnone size-full wp-image-2156 jetpack-lazy-image" src="https://i0.wp.com/blog.fox-it.com/wp-content/uploads/2018/01/mitm6_cropped.png?resize=800%2C198&#038;ssl=1" alt="mitm6_cropped" width="800" height="198" data-recalc-dims="1" data-lazy-src="https://i0.wp.com/blog.fox-it.com/wp-content/uploads/2018/01/mitm6_cropped.png?resize=800%2C198&amp;is-pending-load=1#038;ssl=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"><noscript><img data-lazy-fallback="1" data-attachment-id="2156" data-permalink="https://blog.fox-it.com/2018/01/11/mitm6-compromising-ipv4-networks-via-ipv6/mitm6_cropped/" data-orig-file="https://i0.wp.com/blog.fox-it.com/wp-content/uploads/2018/01/mitm6_cropped.png?fit=1172%2C290&amp;ssl=1" data-orig-size="1172,290" data-comments-opened="0" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="mitm6_cropped" data-image-description="" data-image-caption="" data-medium-file="https://i0.wp.com/blog.fox-it.com/wp-content/uploads/2018/01/mitm6_cropped.png?fit=300%2C74&amp;ssl=1" data-large-file="https://i0.wp.com/blog.fox-it.com/wp-content/uploads/2018/01/mitm6_cropped.png?fit=800%2C198&amp;ssl=1" loading="lazy" class="alignnone size-full wp-image-2156" src="https://i0.wp.com/blog.fox-it.com/wp-content/uploads/2018/01/mitm6_cropped.png?resize=800%2C198&#038;ssl=1" alt="mitm6_cropped" width="800" height="198" data-recalc-dims="1"  /></noscript></p>
<h2>Defenses and mitigations</h2>
<p>The only defense against this attack that we are currently aware of is disabling IPv6 if it is not used on your internal network. This will stop Windows clients querying for a DHCPv6 server and make it impossible to take over the DNS server with the above described method.<br />
For the WPAD exploit, the best solution is to disable the Proxy Auto detection via Group Policy. If your company uses a proxy configuration file internally (PAC file) it is recommended to explicitly configure the PAC url instead of relying on WPAD to detect it automatically.<br />
While writing this blog, Google Project Zero also discovered vulnerabilities in WPAD, and their <a href="https://googleprojectzero.blogspot.com/2017/12/apacolypse-now-exploiting-windows-10-in_18.html">blog post</a> mentions that disabling the <code>WinHttpAutoProxySvc</code> is the only reliable way that in their experience disabled WPAD.</p>
<p>Lastly, the only complete solution to prevent NTLM relaying is to disable it entirely and switch to Kerberos. If this is not possible, our <a href="https://blog.fox-it.com/2017/05/09/relaying-credentials-everywhere-with-ntlmrelayx/">last blog post on NTLM relaying</a> mentions several mitigations to minimize the risk of relaying attacks.</p>
<h3>Detection</h3>
<p>The Fox-IT Security Research Team team has released Snort and Suricata signatures to detect rogue DHCPv6 traffic and WPAD replies over IPv6:</p>
<style>.gist table { margin-bottom: 0; }</style><div style="tab-size: 8" id="gist86047558" class="gist">
    <div class="gist-file" translate="no">
      <div class="gist-data">
        <div class="js-gist-file-update-container js-task-list-container file-box">
  <div id="file-mitm6-rules" class="file my-2">
    
    <div itemprop="text" class="Box-body p-0 blob-wrapper data type-text  ">

        
<div class="js-check-bidi js-blob-code-container blob-code-content">

  <template class="js-file-alert-template">
  <div data-view-component="true" class="flash flash-warn flash-full d-flex flex-items-center">
  <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-alert">
    <path fill-rule="evenodd" d="M8.22 1.754a.25.25 0 00-.44 0L1.698 13.132a.25.25 0 00.22.368h12.164a.25.25 0 00.22-.368L8.22 1.754zm-1.763-.707c.659-1.234 2.427-1.234 3.086 0l6.082 11.378A1.75 1.75 0 0114.082 15H1.918a1.75 1.75 0 01-1.543-2.575L6.457 1.047zM9 11a1 1 0 11-2 0 1 1 0 012 0zm-.25-5.25a.75.75 0 00-1.5 0v2.5a.75.75 0 001.5 0v-2.5z"></path>
</svg>
  
    <span>
      This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
      <a href="https://github.co/hiddenchars" target="_blank">Learn more about bidirectional Unicode characters</a>
    </span>


  <div data-view-component="true" class="flash-action">        <a href="{{ revealButtonHref }}" data-view-component="true" class="btn-sm btn">    Show hidden characters
</a>
</div>
</div></template>
<template class="js-line-alert-template">
  <span aria-label="This line has hidden Unicode characters" data-view-component="true" class="line-alert tooltipped tooltipped-e">
    <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-alert">
    <path fill-rule="evenodd" d="M8.22 1.754a.25.25 0 00-.44 0L1.698 13.132a.25.25 0 00.22.368h12.164a.25.25 0 00.22-.368L8.22 1.754zm-1.763-.707c.659-1.234 2.427-1.234 3.086 0l6.082 11.378A1.75 1.75 0 0114.082 15H1.918a1.75 1.75 0 01-1.543-2.575L6.457 1.047zM9 11a1 1 0 11-2 0 1 1 0 012 0zm-.25-5.25a.75.75 0 00-1.5 0v2.5a.75.75 0 001.5 0v-2.5z"></path>
</svg>
</span></template>

  <table data-hpc class="highlight tab-size js-file-line-container js-code-nav-container js-tagsearch-file" data-tab-size="8" data-paste-markdown-skip data-tagsearch-lang="" data-tagsearch-path="mitm6.rules">
        <tr>
          <td id="file-mitm6-rules-L1" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1"></td>
          <td id="file-mitm6-rules-LC1" class="blob-code blob-code-inner js-file-line"># Snort &amp; Suricata signatures for:</td>
        </tr>
        <tr>
          <td id="file-mitm6-rules-L2" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2"></td>
          <td id="file-mitm6-rules-LC2" class="blob-code blob-code-inner js-file-line"># <a href="https://blog.fox-it.com/2018/01/11/mitm6-compromising-ipv4-networks-via-ipv6" rel="nofollow">https://blog.fox-it.com/2018/01/11/mitm6-compromising-ipv4-networks-via-ipv6</a></td>
        </tr>
        <tr>
          <td id="file-mitm6-rules-L3" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3"></td>
          <td id="file-mitm6-rules-LC3" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="file-mitm6-rules-L4" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4"></td>
          <td id="file-mitm6-rules-LC4" class="blob-code blob-code-inner js-file-line">alert udp fe80::/12 [546,547] -&gt; fe80::/12 [546,547] (msg:&quot;FOX-SRT - Policy - DHCPv6 advertise&quot;; content:&quot;|02|&quot;; offset:48; depth:1; reference:url,blog.fox-it.com/2018/01/11/mitm6-compromising-ipv4-networks-via-ipv6/; threshold:type limit, track by_src, count 1, seconds 3600; classtype:policy-violation; sid:21002327; rev:2;)</td>
        </tr>
        <tr>
          <td id="file-mitm6-rules-L5" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="5"></td>
          <td id="file-mitm6-rules-LC5" class="blob-code blob-code-inner js-file-line">alert udp ::/0 53 -&gt; any any (msg:&quot;FOX-SRT - Suspicious - WPAD DNS reponse over IPv6&quot;; byte_test:1,&amp;,0x7F,2; byte_test:2,&gt;,0,6; content:&quot;|00 04|wpad&quot;; nocase; fast_pattern; threshold: type limit, track by_src, count 1, seconds 1800; reference:url,blog.fox-it.com/2018/01/11/mitm6-compromising-ipv4-networks-via-ipv6/; classtype:attempted-admin; priority:1; sid:21002330; rev:1;)</td>
        </tr>
  </table>
</div>


    </div>

  </div>
</div>

      </div>
      <div class="gist-meta">
        <a href="https://gist.github.com/fox-srt/98f29051fe56a1695de8e914c4a2373f/raw/aa9849eacc084da7e9c3cff20585780f0542f3bf/mitm6.rules" style="float:right">view raw</a>
        <a href="https://gist.github.com/fox-srt/98f29051fe56a1695de8e914c4a2373f#file-mitm6-rules">
          mitm6.rules
        </a>
        hosted with &#10084; by <a href="https://github.com">GitHub</a>
      </div>
    </div>
</div>

<h2>Where to get the tools</h2>
<p>mitm6 is available from the <a href="https://github.com/fox-it/mitm6">Fox-IT GitHub</a>. The updated version of ntlmrelayx is available from the <a href="https://github.com/CoreSecurity/impacket/">impacket repository</a>.</p>
<div class="sharedaddy sd-sharing-enabled"><div class="robots-nocontent sd-block sd-social sd-social-icon-text sd-sharing"><h3 class="sd-title">Share this:</h3><div class="sd-content"><ul><li class="share-email"><a rel="nofollow noopener noreferrer" data-shared="" class="share-email sd-button share-icon" href="mailto:?subject=%5BShared%20Post%5D%20mitm6%20-%20compromising%20IPv4%20networks%20via%20IPv6&body=https%3A%2F%2Fblog.fox-it.com%2F2018%2F01%2F11%2Fmitm6-compromising-ipv4-networks-via-ipv6%2F&share=email" target="_blank" title="Click to email a link to a friend" data-email-share-error-title="Do you have email set up?" data-email-share-error-text="If you&#039;re having problems sharing via email, you might not have email set up for your browser. You may need to create a new email yourself." data-email-share-nonce="bce75ab10e" data-email-share-track-url="https://blog.fox-it.com/2018/01/11/mitm6-compromising-ipv4-networks-via-ipv6/?share=email"><span>Email</span></a></li><li class="share-facebook"><a rel="nofollow noopener noreferrer" data-shared="sharing-facebook-2154" class="share-facebook sd-button share-icon" href="https://blog.fox-it.com/2018/01/11/mitm6-compromising-ipv4-networks-via-ipv6/?share=facebook" target="_blank" title="Click to share on Facebook" ><span>Facebook</span></a></li><li class="share-linkedin"><a rel="nofollow noopener noreferrer" data-shared="sharing-linkedin-2154" class="share-linkedin sd-button share-icon" href="https://blog.fox-it.com/2018/01/11/mitm6-compromising-ipv4-networks-via-ipv6/?share=linkedin" target="_blank" title="Click to share on LinkedIn" ><span>LinkedIn</span></a></li><li class="share-twitter"><a rel="nofollow noopener noreferrer" data-shared="sharing-twitter-2154" class="share-twitter sd-button share-icon" href="https://blog.fox-it.com/2018/01/11/mitm6-compromising-ipv4-networks-via-ipv6/?share=twitter" target="_blank" title="Click to share on Twitter" ><span>Twitter</span></a></li><li class="share-pocket"><a rel="nofollow noopener noreferrer" data-shared="" class="share-pocket sd-button share-icon" href="https://blog.fox-it.com/2018/01/11/mitm6-compromising-ipv4-networks-via-ipv6/?share=pocket" target="_blank" title="Click to share on Pocket" ><span>Pocket</span></a></li><li class="share-end"></li></ul></div></div></div><div class='sharedaddy sd-block sd-like jetpack-likes-widget-wrapper jetpack-likes-widget-unloaded' id='like-post-wrapper-13954993-2154-632f3908a57f1' data-src='https://widgets.wp.com/likes/#blog_id=13954993&amp;post_id=2154&amp;origin=blog.fox-it.com&amp;obj_id=13954993-2154-632f3908a57f1' data-name='like-post-frame-13954993-2154-632f3908a57f1' data-title='Like or Reblog'><h3 class="sd-title">Like this:</h3><div class='likes-widget-placeholder post-likes-widget-placeholder' style='height: 55px;'><span class='button'><span>Like</span></span> <span class="loading">Loading...</span></div><span class='sd-text-color'></span><a class='sd-link-color'></a></div>	</div><!-- .entry-content -->

	<div class="entry-footer">
		<ul class="post-tags light-text"><li>Tagged</li><li><a href="https://blog.fox-it.com/tag/active-directory/" rel="tag">active directory</a></li><li><a href="https://blog.fox-it.com/tag/hacking/" rel="tag">hacking</a></li><li><a href="https://blog.fox-it.com/tag/ipv6/" rel="tag">ipv6</a></li><li><a href="https://blog.fox-it.com/tag/ntlm-relaying/" rel="tag">ntlm relaying</a></li></ul><!-- .post-tags -->	</div><!-- .entry-footer -->

	<div class="entry-author-wrapper">
				<div class="site-posted-on">
			<strong>Published</strong>
			<time class="entry-date published" datetime="2018-01-11T11:32:11+02:00">January 11, 2018</time><time class="updated" datetime="2020-08-12T16:21:05+02:00">August 12, 2020</time>		</div><!-- .site-posted-on -->
	</div>
</article><!-- #post-## -->

			
	<nav class="navigation post-navigation" aria-label="Posts">
		<h2 class="screen-reader-text">Post navigation</h2>
		<div class="nav-links"><div class="nav-previous"><a href="https://blog.fox-it.com/2017/12/14/lessons-learned-from-a-man-in-the-middle-attack/" rel="prev"><span class="meta-nav screen-reader-text">Previous Post</span> Lessons learned from a Man-in-the-Middle attack</a></div><div class="nav-next"><a href="https://blog.fox-it.com/2018/04/06/compromising-sharefile-on-premise-via-7-chained-vulnerabilities/" rel="next"><span class="meta-nav screen-reader-text">Next Post</span> Compromising Citrix ShareFile on-premise via 7 chained vulnerabilities</a></div></div>
	</nav>
			
		
		</main><!-- #main -->
	</div><!-- #primary -->

		</div><!-- #content -->

		<footer id="colophon" class="site-footer" role="contentinfo">
						<div class="site-info">
				<a></a>
				
							</div><!-- .site-info -->
		</footer><!-- #colophon -->
	</div><!-- #content-wrapper -->
</div><!-- #page -->

<!--  -->
<script defer id="bilmur" data-provider="wordpress.com" data-service="atomic"  src="https://s0.wp.com/wp-content/js/bilmur.min.js?m=202238"></script>
		<div id="jp-carousel-loading-overlay">
			<div id="jp-carousel-loading-wrapper">
				<span id="jp-carousel-library-loading">&nbsp;</span>
			</div>
		</div>
		<div class="jp-carousel-overlay" style="display: none;">

		<div class="jp-carousel-container">
			<!-- The Carousel Swiper -->
			<div
				class="jp-carousel-wrap swiper-container jp-carousel-swiper-container jp-carousel-transitions"
				itemscope
				itemtype="https://schema.org/ImageGallery">
				<div class="jp-carousel swiper-wrapper"></div>
				<div class="jp-swiper-button-prev swiper-button-prev">
					<svg width="25" height="24" viewBox="0 0 25 24" fill="none" xmlns="http://www.w3.org/2000/svg">
						<mask id="maskPrev" mask-type="alpha" maskUnits="userSpaceOnUse" x="8" y="6" width="9" height="12">
							<path d="M16.2072 16.59L11.6496 12L16.2072 7.41L14.8041 6L8.8335 12L14.8041 18L16.2072 16.59Z" fill="white"/>
						</mask>
						<g mask="url(#maskPrev)">
							<rect x="0.579102" width="23.8823" height="24" fill="#FFFFFF"/>
						</g>
					</svg>
				</div>
				<div class="jp-swiper-button-next swiper-button-next">
					<svg width="25" height="24" viewBox="0 0 25 24" fill="none" xmlns="http://www.w3.org/2000/svg">
						<mask id="maskNext" mask-type="alpha" maskUnits="userSpaceOnUse" x="8" y="6" width="8" height="12">
							<path d="M8.59814 16.59L13.1557 12L8.59814 7.41L10.0012 6L15.9718 12L10.0012 18L8.59814 16.59Z" fill="white"/>
						</mask>
						<g mask="url(#maskNext)">
							<rect x="0.34375" width="23.8822" height="24" fill="#FFFFFF"/>
						</g>
					</svg>
				</div>
			</div>
			<!-- The main close buton -->
			<div class="jp-carousel-close-hint">
				<svg width="25" height="24" viewBox="0 0 25 24" fill="none" xmlns="http://www.w3.org/2000/svg">
					<mask id="maskClose" mask-type="alpha" maskUnits="userSpaceOnUse" x="5" y="5" width="15" height="14">
						<path d="M19.3166 6.41L17.9135 5L12.3509 10.59L6.78834 5L5.38525 6.41L10.9478 12L5.38525 17.59L6.78834 19L12.3509 13.41L17.9135 19L19.3166 17.59L13.754 12L19.3166 6.41Z" fill="white"/>
					</mask>
					<g mask="url(#maskClose)">
						<rect x="0.409668" width="23.8823" height="24" fill="#FFFFFF"/>
					</g>
				</svg>
			</div>
			<!-- Image info, comments and meta -->
			<div class="jp-carousel-info">
				<div class="jp-carousel-info-footer">
					<div class="jp-carousel-pagination-container">
						<div class="jp-swiper-pagination swiper-pagination"></div>
						<div class="jp-carousel-pagination"></div>
					</div>
					<div class="jp-carousel-photo-title-container">
						<h2 class="jp-carousel-photo-caption"></h2>
					</div>
					<div class="jp-carousel-photo-icons-container">
						<a href="#" class="jp-carousel-icon-btn jp-carousel-icon-info" aria-label="Toggle photo metadata visibility">
							<span class="jp-carousel-icon">
								<svg width="25" height="24" viewBox="0 0 25 24" fill="none" xmlns="http://www.w3.org/2000/svg">
									<mask id="maskInfo" mask-type="alpha" maskUnits="userSpaceOnUse" x="2" y="2" width="21" height="20">
										<path fill-rule="evenodd" clip-rule="evenodd" d="M12.7537 2C7.26076 2 2.80273 6.48 2.80273 12C2.80273 17.52 7.26076 22 12.7537 22C18.2466 22 22.7046 17.52 22.7046 12C22.7046 6.48 18.2466 2 12.7537 2ZM11.7586 7V9H13.7488V7H11.7586ZM11.7586 11V17H13.7488V11H11.7586ZM4.79292 12C4.79292 16.41 8.36531 20 12.7537 20C17.142 20 20.7144 16.41 20.7144 12C20.7144 7.59 17.142 4 12.7537 4C8.36531 4 4.79292 7.59 4.79292 12Z" fill="white"/>
									</mask>
									<g mask="url(#maskInfo)">
										<rect x="0.8125" width="23.8823" height="24" fill="#FFFFFF"/>
									</g>
								</svg>
							</span>
						</a>
												<a href="#" class="jp-carousel-icon-btn jp-carousel-icon-comments" aria-label="Toggle photo comments visibility">
							<span class="jp-carousel-icon">
								<svg width="25" height="24" viewBox="0 0 25 24" fill="none" xmlns="http://www.w3.org/2000/svg">
									<mask id="maskComments" mask-type="alpha" maskUnits="userSpaceOnUse" x="2" y="2" width="21" height="20">
										<path fill-rule="evenodd" clip-rule="evenodd" d="M4.3271 2H20.2486C21.3432 2 22.2388 2.9 22.2388 4V16C22.2388 17.1 21.3432 18 20.2486 18H6.31729L2.33691 22V4C2.33691 2.9 3.2325 2 4.3271 2ZM6.31729 16H20.2486V4H4.3271V18L6.31729 16Z" fill="white"/>
									</mask>
									<g mask="url(#maskComments)">
										<rect x="0.34668" width="23.8823" height="24" fill="#FFFFFF"/>
									</g>
								</svg>

								<span class="jp-carousel-has-comments-indicator" aria-label="This image has comments."></span>
							</span>
						</a>
											</div>
				</div>
				<div class="jp-carousel-info-extra">
					<div class="jp-carousel-info-content-wrapper">
						<div class="jp-carousel-photo-title-container">
							<h2 class="jp-carousel-photo-title"></h2>
						</div>
						<div class="jp-carousel-comments-wrapper">
															<div id="jp-carousel-comments-loading">
									<span>Loading Comments...</span>
								</div>
								<div class="jp-carousel-comments"></div>
								<div id="jp-carousel-comment-form-container">
									<span id="jp-carousel-comment-form-spinner">&nbsp;</span>
									<div id="jp-carousel-comment-post-results"></div>
																														<form id="jp-carousel-comment-form">
												<label for="jp-carousel-comment-form-comment-field" class="screen-reader-text">Write a Comment...</label>
												<textarea
													name="comment"
													class="jp-carousel-comment-form-field jp-carousel-comment-form-textarea"
													id="jp-carousel-comment-form-comment-field"
													placeholder="Write a Comment..."
												></textarea>
												<div id="jp-carousel-comment-form-submit-and-info-wrapper">
													<div id="jp-carousel-comment-form-commenting-as">
																													<fieldset>
																<label for="jp-carousel-comment-form-email-field">Email (Required)</label>
																<input type="text" name="email" class="jp-carousel-comment-form-field jp-carousel-comment-form-text-field" id="jp-carousel-comment-form-email-field" />
															</fieldset>
															<fieldset>
																<label for="jp-carousel-comment-form-author-field">Name (Required)</label>
																<input type="text" name="author" class="jp-carousel-comment-form-field jp-carousel-comment-form-text-field" id="jp-carousel-comment-form-author-field" />
															</fieldset>
															<fieldset>
																<label for="jp-carousel-comment-form-url-field">Website</label>
																<input type="text" name="url" class="jp-carousel-comment-form-field jp-carousel-comment-form-text-field" id="jp-carousel-comment-form-url-field" />
															</fieldset>
																											</div>
													<input
														type="submit"
														name="submit"
														class="jp-carousel-comment-form-button"
														id="jp-carousel-comment-form-button-submit"
														value="Post Comment" />
												</div>
											</form>
																											</div>
													</div>
						<div class="jp-carousel-image-meta">
							<div class="jp-carousel-title-and-caption">
								<div class="jp-carousel-photo-info">
									<h3 class="jp-carousel-caption" itemprop="caption description"></h3>
								</div>

								<div class="jp-carousel-photo-description"></div>
							</div>
							<ul class="jp-carousel-image-exif" style="display: none;"></ul>
							<a class="jp-carousel-image-download" target="_blank" style="display: none;">
								<svg width="25" height="24" viewBox="0 0 25 24" fill="none" xmlns="http://www.w3.org/2000/svg">
									<mask id="mask0" mask-type="alpha" maskUnits="userSpaceOnUse" x="3" y="3" width="19" height="18">
										<path fill-rule="evenodd" clip-rule="evenodd" d="M5.84615 5V19H19.7775V12H21.7677V19C21.7677 20.1 20.8721 21 19.7775 21H5.84615C4.74159 21 3.85596 20.1 3.85596 19V5C3.85596 3.9 4.74159 3 5.84615 3H12.8118V5H5.84615ZM14.802 5V3H21.7677V10H19.7775V6.41L9.99569 16.24L8.59261 14.83L18.3744 5H14.802Z" fill="white"/>
									</mask>
									<g mask="url(#mask0)">
										<rect x="0.870605" width="23.8823" height="24" fill="#FFFFFF"/>
									</g>
								</svg>
								<span class="jp-carousel-download-text"></span>
							</a>
							<div class="jp-carousel-image-map" style="display: none;"></div>
						</div>
					</div>
				</div>
			</div>
		</div>

		</div>
		
	<script type="text/javascript">
		window.WPCOM_sharing_counts = {"https:\/\/blog.fox-it.com\/2018\/01\/11\/mitm6-compromising-ipv4-networks-via-ipv6\/":2154};
	</script>
				<link rel='stylesheet' id='all-css-5ab6d8717115e6588fc3467c0f075e85' href='https://blog.fox-it.com/_static/??-eJyVjFsKgCAQAC+UbWYEfURnMV3C8oXr4vUjqAP0O8NMy8KkWDFWyJ4PFwlOrFmbC0Ky7JHA6JKY0AM1l7GInaP12Buirv2oXyE+8Ay2sMpZyWFcpJpuzec0Gg==' type='text/css' media='all' />
<link rel='stylesheet' id='jetpack-gist-styling-css'  href='https://github.githubassets.com/assets/gist-embed-765f783546ef.css?ver=11.4-a.7' media='all' />
<script id='jetpack-lazy-images-js-extra'>
var jetpackLazyImagesL10n = {"loading_warning":"Images are still loading. Please cancel your print and try again."};
</script>
<script id='jetpack-carousel-js-extra'>
var jetpackSwiperLibraryPath = {"url":"https:\/\/blog.fox-it.com\/wp-content\/plugins\/jetpack\/_inc\/build\/carousel\/swiper-bundle.min.js"};
var jetpackCarouselStrings = {"widths":[370,700,1000,1200,1400,2000],"is_logged_in":"","lang":"en","ajaxurl":"https:\/\/blog.fox-it.com\/wp-admin\/admin-ajax.php","nonce":"516ea55060","display_exif":"1","display_comments":"1","single_image_gallery":"1","single_image_gallery_media_file":"","background_color":"black","comment":"Comment","post_comment":"Post Comment","write_comment":"Write a Comment...","loading_comments":"Loading Comments...","download_original":"View full size <span class=\"photo-size\">{0}<span class=\"photo-size-times\">\u00d7<\/span>{1}<\/span>","no_comment_text":"Please be sure to submit some text with your comment.","no_comment_email":"Please provide an email address to comment.","no_comment_author":"Please provide your name to comment.","comment_post_error":"Sorry, but there was an error posting your comment. Please try again later.","comment_approved":"Your comment was approved.","comment_unapproved":"Your comment is in moderation.","camera":"Camera","aperture":"Aperture","shutter_speed":"Shutter Speed","focal_length":"Focal Length","copyright":"Copyright","comment_registration":"0","require_name_email":"1","login_url":"https:\/\/blog.fox-it.com\/wp-login.php?redirect_to=https%3A%2F%2Fblog.fox-it.com%2F2018%2F01%2F11%2Fmitm6-compromising-ipv4-networks-via-ipv6%2F","blog_id":"1","meta_data":["camera","aperture","shutter_speed","focal_length","copyright"]};
</script>
<script type='text/javascript'  src='https://blog.fox-it.com/_static/??-eJytkmFLxDAMhv+QvaLi2BfxpxxdltuydUlt2k399Xaw6aEecuKXBhLep+EhSzAgnJCTDT53xGoHTMHBaI/EYJtMvrWhlyS8lcNEfBj0ZvkeBWm8wKi2JU12+GwYxzS5RPI1mXqcUC1xiwHLw8mE3HjSHqO5WxHsZur+Fr0wupqjIwXjiUdzEshqTvRyHWM1qRApJLMEkOmCvt38Vo9zQUm0Licp8hLBPjHevb2aYrTDzTUVUlSE1ZORRjHOGP//m7PGL/Cz6/E0lvxzxoy949aXxS6f0A95cFGyov9Ya29smKfp8baq7uuqfqird4BWEqM='></script>
<script id='sharing-js-js-extra'>
var sharing_js_options = {"lang":"en","counts":"1","is_stats_active":"1"};
</script>
<script src='https://blog.fox-it.com/wp-content/plugins/jetpack/_inc/build/sharedaddy/sharing.min.js?ver=11.4-a.7' id='sharing-js-js'></script>
<script id='sharing-js-js-after'>
var windowOpen;
			( function () {
				function matches( el, sel ) {
					return !! (
						el.matches && el.matches( sel ) ||
						el.msMatchesSelector && el.msMatchesSelector( sel )
					);
				}

				document.body.addEventListener( 'click', function ( event ) {
					if ( ! event.target ) {
						return;
					}

					var el;
					if ( matches( event.target, 'a.share-facebook' ) ) {
						el = event.target;
					} else if ( event.target.parentNode && matches( event.target.parentNode, 'a.share-facebook' ) ) {
						el = event.target.parentNode;
					}

					if ( el ) {
						event.preventDefault();

						// If there's another sharing window open, close it.
						if ( typeof windowOpen !== 'undefined' ) {
							windowOpen.close();
						}
						windowOpen = window.open( el.getAttribute( 'href' ), 'wpcomfacebook', 'menubar=1,resizable=1,width=600,height=400' );
						return false;
					}
				} );
			} )();
var windowOpen;
			( function () {
				function matches( el, sel ) {
					return !! (
						el.matches && el.matches( sel ) ||
						el.msMatchesSelector && el.msMatchesSelector( sel )
					);
				}

				document.body.addEventListener( 'click', function ( event ) {
					if ( ! event.target ) {
						return;
					}

					var el;
					if ( matches( event.target, 'a.share-linkedin' ) ) {
						el = event.target;
					} else if ( event.target.parentNode && matches( event.target.parentNode, 'a.share-linkedin' ) ) {
						el = event.target.parentNode;
					}

					if ( el ) {
						event.preventDefault();

						// If there's another sharing window open, close it.
						if ( typeof windowOpen !== 'undefined' ) {
							windowOpen.close();
						}
						windowOpen = window.open( el.getAttribute( 'href' ), 'wpcomlinkedin', 'menubar=1,resizable=1,width=580,height=450' );
						return false;
					}
				} );
			} )();
var windowOpen;
			( function () {
				function matches( el, sel ) {
					return !! (
						el.matches && el.matches( sel ) ||
						el.msMatchesSelector && el.msMatchesSelector( sel )
					);
				}

				document.body.addEventListener( 'click', function ( event ) {
					if ( ! event.target ) {
						return;
					}

					var el;
					if ( matches( event.target, 'a.share-twitter' ) ) {
						el = event.target;
					} else if ( event.target.parentNode && matches( event.target.parentNode, 'a.share-twitter' ) ) {
						el = event.target.parentNode;
					}

					if ( el ) {
						event.preventDefault();

						// If there's another sharing window open, close it.
						if ( typeof windowOpen !== 'undefined' ) {
							windowOpen.close();
						}
						windowOpen = window.open( el.getAttribute( 'href' ), 'wpcomtwitter', 'menubar=1,resizable=1,width=600,height=350' );
						return false;
					}
				} );
			} )();
var windowOpen;
			( function () {
				function matches( el, sel ) {
					return !! (
						el.matches && el.matches( sel ) ||
						el.msMatchesSelector && el.msMatchesSelector( sel )
					);
				}

				document.body.addEventListener( 'click', function ( event ) {
					if ( ! event.target ) {
						return;
					}

					var el;
					if ( matches( event.target, 'a.share-pocket' ) ) {
						el = event.target;
					} else if ( event.target.parentNode && matches( event.target.parentNode, 'a.share-pocket' ) ) {
						el = event.target.parentNode;
					}

					if ( el ) {
						event.preventDefault();

						// If there's another sharing window open, close it.
						if ( typeof windowOpen !== 'undefined' ) {
							windowOpen.close();
						}
						windowOpen = window.open( el.getAttribute( 'href' ), 'wpcompocket', 'menubar=1,resizable=1,width=450,height=450' );
						return false;
					}
				} );
			} )();
</script>
	<iframe src='https://widgets.wp.com/likes/master.html?ver=202238#ver=202238' scrolling='no' id='likes-master' name='likes-master' style='display:none;'></iframe>
	<div id='likes-other-gravatars'><div class="likes-text"><span>%d</span> bloggers like this:</div><ul class="wpl-avatars sd-like-gravatars"></ul></div>
	<script src='https://stats.wp.com/e-202238.js' defer></script>
<script>
	_stq = window._stq || [];
	_stq.push([ 'view', {v:'ext',j:'1:11.4-a.7',blog:'13954993',post:'2154',tz:'2',srv:'blog.fox-it.com',hp:'atomic',ac:'2',amp:'0'} ]);
	_stq.push([ 'clickTrackerInit', '13954993', '2154' ]);
</script>

</body>
</html>
<!--
	generated in 0.458 seconds
	92080 bytes batcached for 300 seconds
-->
